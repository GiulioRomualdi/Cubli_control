function state = angles(theta, state0)

t = 1;
theta = theta * pi / 180;

R0 = rotx(state0(1))*roty(state0(2))*rotz(state0(3));
Rf = rotz(theta) * R0;

q0 = rotm2quat(R0);
q1 = rotm2quat(Rf);

q01 = q0(1);
q02 = q0(2);
q03 = q0(3);
q04 = q0(4);

q11 = q1(1);
q12 = q1(2);
q13 = q1(3);
q14 = q1(4);

th1_des = atan2(2.*csc((1/2).*theta).^2.*((q01.*q02+(-1).* ...
  q03.*q04).*sin((1/2).*(1+(-1).*t).*theta).^2+(q02.*q11+q01.*q12+(-1).* ...
  q04.*q13+(-1).*q03.*q14).*sin((1/2).*(1+(-1).*t).*theta).*sin((1/2).*t.* ...
  theta)+(q11.*q12+(-1).*q13.*q14).*sin((1/2).*t.*theta).^2).*(4.*csc(( ...
  1/2).*theta).^4.*(((-1).*q01.*q02+q03.*q04).*sin((1/2).*(1+(-1).*t).* ...
  theta).^2+(-1).*(q02.*q11+q01.*q12+(-1).*q04.*q13+(-1).*q03.*q14).*sin(( ...
  1/2).*(1+(-1).*t).*theta).*sin((1/2).*t.*theta)+((-1).*q11.*q12+q13.* ...
  q14).*sin((1/2).*t.*theta).^2).^2+(1+(-2).*csc((1/2).*theta).^2.*((q02.* ...
  sin((1/2).*(1+(-1).*t).*theta)+q12.*sin((1/2).*t.*theta)).^2+(q03.*sin(( ...
  1/2).*(1+(-1).*t).*theta)+q13.*sin((1/2).*t.*theta)).^2)).^2).^(-1/2).*( ...
  4.*csc((1/2).*theta).^4.*((q01.*q03+q02.*q04).*sin((1/2).*(1+(-1).*t).* ...
  theta).^2+(q03.*q11+q04.*q12+q01.*q13+q02.*q14).*sin((1/2).*(1+(-1).*t) ...
  .*theta).*sin((1/2).*t.*theta)+(q11.*q13+q12.*q14).*sin((1/2).*t.*theta) ...
  .^2).^2+4.*csc((1/2).*theta).^4.*(((-1).*q01.*q02+q03.*q04).*sin((1/2).* ...
  (1+(-1).*t).*theta).^2+(-1).*(q02.*q11+q01.*q12+(-1).*q04.*q13+(-1).* ...
  q03.*q14).*sin((1/2).*(1+(-1).*t).*theta).*sin((1/2).*t.*theta)+((-1).* ...
  q11.*q12+q13.*q14).*sin((1/2).*t.*theta).^2).^2+(1+(-2).*csc((1/2).* ...
  theta).^2.*((q02.*sin((1/2).*(1+(-1).*t).*theta)+q12.*sin((1/2).*t.* ...
  theta)).^2+(q03.*sin((1/2).*(1+(-1).*t).*theta)+q13.*sin((1/2).*t.* ...
  theta)).^2)).^2).^(1/2),...
  (1+(-2).*csc((1/2).*theta).^2.*((q02.^2+q03.^2).*sin((1/2).*(1+(-1) ...
  .*t).*theta).^2+2.*(q02.*q12+q03.*q13).*sin((1/2).*(1+(-1).*t).*theta).* ...
  sin((1/2).*t.*theta)+(q12.^2+q13.^2).*sin((1/2).*t.*theta).^2)).*(4.* ...
  csc((1/2).*theta).^4.*(((-1).*q01.*q02+q03.*q04).*sin((1/2).*(1+(-1).*t) ...
  .*theta).^2+(-1).*(q02.*q11+q01.*q12+(-1).*q04.*q13+(-1).*q03.*q14).* ...
  sin((1/2).*(1+(-1).*t).*theta).*sin((1/2).*t.*theta)+((-1).*q11.*q12+ ...
  q13.*q14).*sin((1/2).*t.*theta).^2).^2+(1+(-2).*csc((1/2).*theta).^2.*(( ...
  q02.*sin((1/2).*(1+(-1).*t).*theta)+q12.*sin((1/2).*t.*theta)).^2+(q03.* ...
  sin((1/2).*(1+(-1).*t).*theta)+q13.*sin((1/2).*t.*theta)).^2)).^2).^( ...
  -1/2).*(4.*csc((1/2).*theta).^4.*((q01.*q03+q02.*q04).*sin((1/2).*(1+( ...
  -1).*t).*theta).^2+(q03.*q11+q04.*q12+q01.*q13+q02.*q14).*sin((1/2).*(1+ ...
  (-1).*t).*theta).*sin((1/2).*t.*theta)+(q11.*q13+q12.*q14).*sin((1/2).* ...
  t.*theta).^2).^2+4.*csc((1/2).*theta).^4.*(((-1).*q01.*q02+q03.*q04).* ...
  sin((1/2).*(1+(-1).*t).*theta).^2+(-1).*(q02.*q11+q01.*q12+(-1).*q04.* ...
  q13+(-1).*q03.*q14).*sin((1/2).*(1+(-1).*t).*theta).*sin((1/2).*t.* ...
  theta)+((-1).*q11.*q12+q13.*q14).*sin((1/2).*t.*theta).^2).^2+(1+(-2).* ...
  csc((1/2).*theta).^2.*((q02.*sin((1/2).*(1+(-1).*t).*theta)+q12.*sin(( ...
  1/2).*t.*theta)).^2+(q03.*sin((1/2).*(1+(-1).*t).*theta)+q13.*sin((1/2) ...
  .*t.*theta)).^2)).^2).^(1/2));

th2_des = atan2(2.*csc((1/2).*theta).^2.*((q01.*q03+q02.*q04).* ...
  sin((1/2).*(1+(-1).*t).*theta).^2+(q03.*q11+q04.*q12+q01.*q13+q02.*q14) ...
  .*sin((1/2).*(1+(-1).*t).*theta).*sin((1/2).*t.*theta)+(q11.*q13+q12.* ...
  q14).*sin((1/2).*t.*theta).^2),...
 (4.*csc((1/2).*theta).^4.*(((-1).*q01.*q02+q03.*q04).*sin((1/2).*( ...
  1+(-1).*t).*theta).^2+(-1).*(q02.*q11+q01.*q12+(-1).*q04.*q13+(-1).* ...
  q03.*q14).*sin((1/2).*(1+(-1).*t).*theta).*sin((1/2).*t.*theta)+((-1).* ...
  q11.*q12+q13.*q14).*sin((1/2).*t.*theta).^2).^2+(1+(-2).*csc((1/2).* ...
  theta).^2.*((q02.*sin((1/2).*(1+(-1).*t).*theta)+q12.*sin((1/2).*t.* ...
  theta)).^2+(q03.*sin((1/2).*(1+(-1).*t).*theta)+q13.*sin((1/2).*t.* ...
  theta)).^2)).^2).^(1/2));

th3_des = atan2((-2).*csc((1/2).*theta).^2.*((q02.*q03+(-1) ...
  .*q01.*q04).*sin((1/2).*(1+(-1).*t).*theta).^2+(-1).*(q04.*q11+(-1).* ...
  q03.*q12+(-1).*q02.*q13+q01.*q14).*sin((1/2).*(1+(-1).*t).*theta).*sin(( ...
  1/2).*t.*theta)+(q12.*q13+(-1).*q11.*q14).*sin((1/2).*t.*theta).^2).*( ...
  4.*csc((1/2).*theta).^4.*(((-1).*q01.*q02+q03.*q04).*sin((1/2).*(1+(-1) ...
  .*t).*theta).^2+(-1).*(q02.*q11+q01.*q12+(-1).*q04.*q13+(-1).*q03.*q14) ...
  .*sin((1/2).*(1+(-1).*t).*theta).*sin((1/2).*t.*theta)+((-1).*q11.*q12+ ...
  q13.*q14).*sin((1/2).*t.*theta).^2).^2+(1+(-2).*csc((1/2).*theta).^2.*(( ...
  q02.*sin((1/2).*(1+(-1).*t).*theta)+q12.*sin((1/2).*t.*theta)).^2+(q03.* ...
  sin((1/2).*(1+(-1).*t).*theta)+q13.*sin((1/2).*t.*theta)).^2)).^2).^( ...
  -1/2).*(4.*csc((1/2).*theta).^4.*((q01.*q03+q02.*q04).*sin((1/2).*(1+( ...
  -1).*t).*theta).^2+(q03.*q11+q04.*q12+q01.*q13+q02.*q14).*sin((1/2).*(1+ ...
  (-1).*t).*theta).*sin((1/2).*t.*theta)+(q11.*q13+q12.*q14).*sin((1/2).* ...
  t.*theta).^2).^2+4.*csc((1/2).*theta).^4.*(((-1).*q01.*q02+q03.*q04).* ...
  sin((1/2).*(1+(-1).*t).*theta).^2+(-1).*(q02.*q11+q01.*q12+(-1).*q04.* ...
  q13+(-1).*q03.*q14).*sin((1/2).*(1+(-1).*t).*theta).*sin((1/2).*t.* ...
  theta)+((-1).*q11.*q12+q13.*q14).*sin((1/2).*t.*theta).^2).^2+(1+(-2).* ...
  csc((1/2).*theta).^2.*((q02.*sin((1/2).*(1+(-1).*t).*theta)+q12.*sin(( ...
  1/2).*t.*theta)).^2+(q03.*sin((1/2).*(1+(-1).*t).*theta)+q13.*sin((1/2) ...
  .*t.*theta)).^2)).^2).^(1/2),...
  (1+(-2).*csc((1/2).*theta).^2.*((q03.^2+q04.^2).*sin((1/2).*(1+(-1) ...
  .*t).*theta).^2+2.*(q03.*q13+q04.*q14).*sin((1/2).*(1+(-1).*t).*theta).* ...
  sin((1/2).*t.*theta)+(q13.^2+q14.^2).*sin((1/2).*t.*theta).^2)).*(4.* ...
  csc((1/2).*theta).^4.*(((-1).*q01.*q02+q03.*q04).*sin((1/2).*(1+(-1).*t) ...
  .*theta).^2+(-1).*(q02.*q11+q01.*q12+(-1).*q04.*q13+(-1).*q03.*q14).* ...
  sin((1/2).*(1+(-1).*t).*theta).*sin((1/2).*t.*theta)+((-1).*q11.*q12+ ...
  q13.*q14).*sin((1/2).*t.*theta).^2).^2+(1+(-2).*csc((1/2).*theta).^2.*(( ...
  q02.*sin((1/2).*(1+(-1).*t).*theta)+q12.*sin((1/2).*t.*theta)).^2+(q03.* ...
  sin((1/2).*(1+(-1).*t).*theta)+q13.*sin((1/2).*t.*theta)).^2)).^2).^( ...
  -1/2).*(4.*csc((1/2).*theta).^4.*((q01.*q03+q02.*q04).*sin((1/2).*(1+( ...
  -1).*t).*theta).^2+(q03.*q11+q04.*q12+q01.*q13+q02.*q14).*sin((1/2).*(1+ ...
  (-1).*t).*theta).*sin((1/2).*t.*theta)+(q11.*q13+q12.*q14).*sin((1/2).* ...
  t.*theta).^2).^2+4.*csc((1/2).*theta).^4.*(((-1).*q01.*q02+q03.*q04).* ...
  sin((1/2).*(1+(-1).*t).*theta).^2+(-1).*(q02.*q11+q01.*q12+(-1).*q04.* ...
  q13+(-1).*q03.*q14).*sin((1/2).*(1+(-1).*t).*theta).*sin((1/2).*t.* ...
  theta)+((-1).*q11.*q12+q13.*q14).*sin((1/2).*t.*theta).^2).^2+(1+(-2).* ...
  csc((1/2).*theta).^2.*((q02.*sin((1/2).*(1+(-1).*t).*theta)+q12.*sin(( ...
  1/2).*t.*theta)).^2+(q03.*sin((1/2).*(1+(-1).*t).*theta)+q13.*sin((1/2) ...
  .*t.*theta)).^2)).^2).^(1/2));
state = [th1_des; th2_des; th3_des; zeros(6,1)];
end